<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eletrosat - Painel de Pontos</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #0d1b2a; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .container { background-color: #1b263b; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); width: 100%; max-width: 400px; }
        h2 { text-align: center; color: #e0e1dd; margin-bottom: 25px; border-bottom: 2px solid #415a77; padding-bottom: 10px; }
        label { display: block; margin-bottom: 5px; color: #a2d2ff; font-weight: bold; }
        input { width: 100%; padding: 12px; margin-bottom: 20px; border: none; border-radius: 8px; background: #e0e1dd; color: #0d1b2a; font-size: 16px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background-color: #4cc9f0; border: none; border-radius: 8px; color: #0d1b2a; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background-color: #4361ee; color: white; }
        #mensagem { text-align: center; margin-top: 15px; font-weight: bold; color: #06d6a0; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Eletrosat - Pontos</h2>
        <form id="formPontos">
            <label>Nome do Instalador</label>
            <input type="text" name="instalador" placeholder="Ex: JoÃ£o da Antena" required>

            <label>Nome do Cliente</label>
            <input type="text" name="cliente" placeholder="Ex: Maria Souza" required>

            <label>Valor da Venda (R$)</label>
            <input type="number" step="0.01" name="valor" placeholder="Valor final (com desconto)" required>

            <button type="submit" id="btn">Registrar Venda</button>
        </form>
        <div id="mensagem"></div>
    </div>

    <script>
        const URL_SCRIPT = 'https://script.google.com/macros/s/AKfycbxrczjuJUMD_f5qyMpA3Uv4GCDMe5JS9y3nNa7I4eow7qGCNYMbSSr2AxXXShv-lBz0gw/exec';

        document.getElementById('formPontos').addEventListener('submit', function(e) {
            e.preventDefault();
            const btn = document.getElementById('btn');
            const msg = document.getElementById('mensagem');
            
            btn.disabled = true;
            btn.innerText = "Processando...";
            msg.innerText = "";

            const formData = new FormData(this);
            const params = new URLSearchParams(formData);

            fetch(URL_SCRIPT, {
                method: 'POST',
                body: params
            })
            .then(res => res.text())
            .then(texto => {
                msg.innerText = texto;
                this.reset();
                btn.disabled = false;
                btn.innerText = "Registrar Venda";
            })
            .catch(err => {
                msg.style.color = "red";
                msg.innerText = "Erro ao enviar!";
                btn.disabled = false;
                btn.innerText = "Tentar Novamente";
            });
        });
    </script>
</body>
</html>